<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Expense Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Expense Tracker</h1>

    <h3>Set Your Budget</h3>
    <form method="POST">
        <input type="hidden" name="form_type" value="budget" />
        <input type="number" step="0.01" name="budget" placeholder="Set Budget" required />
        <button type="submit">Set Budget</button>
    </form>

    <h3>Add New Expense</h3>
    <form method="POST">
        <input type="hidden" name="form_type" value="expense" />
        <input type="text" name="description" placeholder="Description" required />
        <select name="category" required>
            <option value="" disabled selected>Select Category</option>
            <option value="Food">Food</option>
            <option value="Transport">Transport</option>
            <option value="Bills">Bills</option>
            <option value="Entertainment">Entertainment</option>
            <option value="Others">Others</option>
        </select>
        <input type="number" step="0.01" name="amount" placeholder="Amount" required />
        <button type="submit">Add Expense</button>
    </form>

    <h2>Budget: {{ budget }}</h2>
    <h2>Total Expenses: {{ total }}</h2>
    <h2>Remaining: {{ remaining }}</h2>

    <h3>Expenses List</h3>
    <ul>
        {% for exp in expenses %}
            <li>{{ exp.description }} - {{ exp.category }} - ${{ "%.2f"|format(exp.amount) }}</li>
        {% else %}
            <li>No expenses yet.</li>
        {% endfor %}
    </ul>

    <h3>Spending by Category</h3>
    <canvas id="categoryChart" width="600" height="400"></canvas>

    <script>
        fetch('/category-data')
            .then(response => response.json())
            .then(data => {
                const ctx = document.getElementById('categoryChart').getContext('2d');
                const labels = Object.keys(data);
                const amounts = Object.values(data);
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Amount Spent',
                            data: amounts,
                            backgroundColor: '#36A2EB',
                        }]
                    },
                    options: {
                        scales: {
                            y: { beginAtZero: true }
                        },
                        responsive: true,
                    }
                });
            });
    </script>
</body>
</html>


